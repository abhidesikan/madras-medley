<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	{{- $title := ( .Title ) -}}
	{{- $siteTitle := ( .Site.Title ) -}}
	{{- if .IsHome -}}
		<title>{{ $siteTitle }} {{ if isset .Site.Params "subtitle" }}- {{ .Site.Params.Subtitle }}{{ end }}</title>
	{{- else -}}
		<title>{{ $title }} - {{ $siteTitle }}</title>
	{{- end -}}

	{{- if isset .Site.Params "favicon" -}}
		<link rel="icon" type="image/png" href={{ .Site.Params.favicon }} />
	{{- end -}}

	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- Google Search Console Verification -->
	<meta name="google-site-verification" content="XBWYmD4yilTzi6sa7URCYm5XzfzUoQYGuuURF5dwx_c" />

	<!-- SEO Meta Tags -->
	{{- if .Description -}}
		<meta name="description" content="{{ .Description }}">
	{{- else if .Summary -}}
		<meta name="description" content="{{ .Summary | plainify | truncate 160 }}">
	{{- else if .Site.Params.description -}}
		<meta name="description" content="{{ .Site.Params.description }}">
	{{- end -}}

	<meta name="author" content="{{ .Site.Params.author | default .Site.Title }}">
	{{- if .Keywords -}}
		<meta name="keywords" content="{{ delimit .Keywords ", " }}">
	{{- end -}}

	<!-- Open Graph / Facebook -->
	<meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
	<meta property="og:url" content="{{ .Permalink }}">
	<meta property="og:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} - {{ .Site.Title }}{{ end }}">
	{{- if .Description -}}
		<meta property="og:description" content="{{ .Description }}">
	{{- else if .Summary -}}
		<meta property="og:description" content="{{ .Summary | plainify | truncate 160 }}">
	{{- else if .Site.Params.description -}}
		<meta property="og:description" content="{{ .Site.Params.description }}">
	{{- end -}}

	{{- /* Find first image in content for Open Graph */ -}}
	{{- $images := findRE "<img[^>]+src=\"([^\"]+)\"" .Content 1 -}}
	{{- if $images -}}
		{{- $img := index $images 0 -}}
		{{- $src := replaceRE ".*src=\"([^\"]+)\".*" "$1" $img -}}
		{{- if not (hasPrefix $src "http") -}}
			{{- $src = printf "%s%s" .Site.BaseURL (strings.TrimPrefix "/" $src) -}}
		{{- end -}}
		<meta property="og:image" content="{{ $src }}">
		<meta property="og:image:alt" content="{{ .Title }}">
	{{- else if isset .Site.Params "defaultogimage" -}}
		<meta property="og:image" content="{{ .Site.Params.defaultOGImage }}">
	{{- end -}}

	<meta property="og:site_name" content="{{ .Site.Title }}">
	{{- if .IsPage -}}
		<meta property="article:published_time" content="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
		<meta property="article:modified_time" content="{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}">
		{{- with .Params.tags -}}
			{{- range . -}}
				<meta property="article:tag" content="{{ . }}">
			{{- end -}}
		{{- end -}}
	{{- end -}}

	<!-- Twitter Card -->
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:url" content="{{ .Permalink }}">
	<meta name="twitter:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}">
	{{- if .Description -}}
		<meta name="twitter:description" content="{{ .Description }}">
	{{- else if .Summary -}}
		<meta name="twitter:description" content="{{ .Summary | plainify | truncate 160 }}">
	{{- end -}}
	{{- if $images -}}
		{{- $img := index $images 0 -}}
		{{- $src := replaceRE ".*src=\"([^\"]+)\".*" "$1" $img -}}
		{{- if not (hasPrefix $src "http") -}}
			{{- $src = printf "%s%s" .Site.BaseURL (strings.TrimPrefix "/" $src) -}}
		{{- end -}}
		<meta name="twitter:image" content="{{ $src }}">
	{{- else if isset .Site.Params "defaultogimage" -}}
		<meta name="twitter:image" content="{{ .Site.Params.defaultOGImage }}">
	{{- end -}}

	<!-- Canonical URL -->
	<link rel="canonical" href="{{ .Permalink }}">

	<!-- RSS -->
	{{ with .OutputFormats.Get "rss" -}}
		{{ printf `<link rel="%s" type="%s" href="%s" title="%s" />` .Rel .MediaType.Type .Permalink $.Site.Title | safeHTML }}
	{{ end -}}

	<!-- Structured Data (JSON-LD) -->
	{{- if .IsPage -}}
	<script type="application/ld+json">
	{
		"@context": "https://schema.org",
		"@type": "BlogPosting",
		"headline": "{{ .Title }}",
		"datePublished": "{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}",
		"dateModified": "{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}",
		"author": {
			"@type": "Person",
			"name": "{{ .Site.Params.author | default .Site.Title }}"
		},
		"publisher": {
			"@type": "Organization",
			"name": "{{ .Site.Title }}",
			"url": "{{ .Site.BaseURL }}"
		},
		"description": "{{ if .Description }}{{ .Description }}{{ else if .Summary }}{{ .Summary | plainify | truncate 160 }}{{ end }}",
		"url": "{{ .Permalink }}"
		{{- if $images -}}
			{{- $img := index $images 0 -}}
			{{- $src := replaceRE ".*src=\"([^\"]+)\".*" "$1" $img -}}
			{{- if not (hasPrefix $src "http") -}}
				{{- $src = printf "%s%s" .Site.BaseURL (strings.TrimPrefix "/" $src) -}}
			{{- end -}}
		,"image": "{{ $src }}"
		{{- end -}}
	}
	</script>
	{{- end -}}

	<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="{{ .Site.BaseURL }}css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="{{ .Site.BaseURL }}css/main.css" />
	{{- if isset .Site.Params "customcss" }}
		<link rel="stylesheet" type="text/css" href="{{ .Site.BaseURL }}{{ .Site.Params.customCSS }}" />
	{{ end }}

	<link id="dark-scheme" rel="stylesheet" type="text/css" href="{{ .Site.BaseURL }}css/dark.css" />
	{{- if isset .Site.Params "customdarkcss" }}
		<link id="dark-scheme" rel="stylesheet" type="text/css" href="{{ .Site.BaseURL }}{{ .Site.Params.customDarkCSS }}" />
	{{- end }}

	{{ if and (isset .Site.Params "social") (isset .Site.Params "feathericonscdn") (eq .Site.Params.featherIconsCDN true) -}}
		<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
	{{- else if or (isset .Site.Params "social") (eq .Site.Params.mode "auto") (eq .Site.Params.mode "dark") -}}
		<script src="{{ .Site.BaseURL }}js/feather.min.js"></script>
	{{ end }}
	<script src="{{ .Site.BaseURL }}js/main.js"></script>
	{{- if isset .Site.Params "customjs" -}}
		{{- range .Site.Params.customJS }}<script src="{{ $.Site.BaseURL }}{{ . }}"></script>{{- end }}
	{{- end }}
</head>
